$(document).ready(function () {
    var mstUrl = $(location).attr('href');
    localStorage.setItem('masterUrl', $(location).attr('href'));
    function getCurentFileName() {
        var pagePathName = window.location.pathname;
        return pagePathName.substring(pagePathName.lastIndexOf("/") + 1);
    }
    var newUrl = getCurentFileName() + window.location.search;
    localStorage.setItem("historyUrl", newUrl);

    if (localStorage.getItem("historyArray") === null) {
        let historyArr = [];
        historyArr.push(newUrl);
        localStorage.setItem("historyArray", JSON.stringify(historyArr));
    } else {
        let historyArr = JSON.parse(localStorage.getItem("historyArray"));
        if (historyArr[historyArr.length - 1] != newUrl) {
            historyArr.push(newUrl);
        }
        localStorage.setItem("historyArray", JSON.stringify(historyArr));
    }
});


document.addEventListener('visibilitychange', function () {
    if (document.hidden) {
        console.log("hidden");
        let Time_now = (new Date()).getTime();
        localStorage.setItem('Lastclear', Time_now);
        if ("count" in localStorage) {
            let customCounter = (localStorage.getItem("count")) * (-1);
            localStorage.setItem('customCounter', customCounter);
        }
    } else {
        console.log("resume");
    }
});

if (typeof window.tizen !== "undefined") {
    window.tizen.tvinputdevice.registerKey('Exit');
}
document.addEventListener('keydown', function (event) {
    console.log(event.keyCode);
    switch (event.keyCode) {
        case 10182:
            localStorage.setItem("AppExit", "yes")
            window.tizen.application.getCurrentApplication().exit();
    }
});